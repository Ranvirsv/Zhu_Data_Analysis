"0","# set.seed(123) # for reproducibility"
"0",""
"0","clusters <- kmeans(data_for_clustering, centers = 4)"
"0","# "
"0","# Assign cluster labels back to the file_id"
"0","kmean_total_caputer <- total_capture %>%"
"0","  mutate(group = as.factor(clusters$cluster[match(file_id, data_for_clustering$file_id)]))"
"0",""
"0","## Now that we have the clusters, let's get the mean for those groups "
"0",""
"0","group_mean <- kmean_total_caputer |>"
"0","  group_by(year, group) |>"
"0","  summarize(mean_CO2 = mean(Total_CO2_capture, na.rm = TRUE), .groups = 'drop')"
"0",""
"0","plot.k.means.facet <- ggplot() +"
"0","  geom_line(data = kmean_total_caputer, aes(x = year, y = Total_CO2_capture, group = file_id, color = group), alpha = 0.2) +  "
"0","  geom_smooth(data = group_mean, aes(x = year, y = mean_CO2, group = group, color = group), size = 1.5) + "
"0","  facet_wrap( ~ group) + "
"0","  labs(title = ""Total CO2 Capture group vise facet"","
"0","       x = ""Year"","
"0","       y = ""Total CO2 Capture (tonnes CO2/ha)"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""bottom"")"
"0",""
"0","plot.k.means <- ggplot() +"
"0","  geom_line(data = kmean_total_caputer, aes(x = year, y = Total_CO2_capture, group = file_id, color = group), alpha = 0.3) +"
"0","  labs(title = ""Total CO2 Capture group vise"","
"0","       x = ""Year"","
"0","       y = ""Total CO2 Capture (tonnes CO2/ha)"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""none"")"
"0",""
"0","plot.all <- ggplot() +"
"0","  geom_smooth(data = group_mean, aes(x = year, y = mean_CO2, group = group, color = group), level = 0.95) + "
"0","  labs(title = ""Mean CO2 Capture group vise"","
"0","       x = ""Year"","
"0","       y = ""Mean CO2 Capture (tonnes CO2/ha)"") +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""none"")"
"0",""
"0","plot.k.means.facet / (plot.k.means + plot.all)"
