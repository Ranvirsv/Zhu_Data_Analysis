"0","# Create a funtion to prepocess and join all the files"
"0","process_file <- function(file, file_id){"
"0","  file_number <- str_extract(file, ""(?<=/)[^/]+(?=\\.out$)"") # Extracting the file number"
"0","  data <- read.table(file, header = TRUE) |>"
"0","    filter(state == ""transp"") |> # Get the files which have state as transp"
"0","    mutate(year = time/(3600*24*365)) |> # Convert form sec to year"
"0","    rename(`C(4)` = ""C.4."") |>"
"0","    select(c('soln', 'Calcite', 'Sr', 'C(4)', 'year')) |>"
"0","    group_by(year) |>"
"0","    mutate(avg_calcite = ifelse(soln %in% 1:10, mean(Calcite[soln %in% 1:10]), Calcite)) |> # Getting the average value for Calcite"
"0","    ungroup() |>"
"0","    # Conversions from mole/liter to CO2/Ha"
"0","    mutate(Calcite = avg_calcite,"
"0","           Calcite = Calcite * 500000 * 44 / 1000000 / ifelse(soln %in% 1:10, 1, 10),"
"0","           `C(4)` = `C(4)` * 500000 * 44 / 1000000 / 10,"
"0","           file_id = file_id) |>"
"0","    select(-avg_calcite)"
"0","  return(data)"
"0","}"
